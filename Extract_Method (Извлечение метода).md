Извлечение метода

Проблема: у вас есть фрагмент кода, который можно сгруппировать.

Решение: выделите участок кода в новый метод (или функцию) и вызовите этот метод вместо старого кода.

Причины рефакторинга: чем больше строк кода в методе, тем сложнее разобраться в том, что он делает. Это основная проблема, которую решает этот рефакторинг.

Извлечение метода не только убивает множество запашков в коде, но и является одним из этапов множества других рефакторингов.

Достоинства

1. Улучшает читабельность кода. Постарайтесь дать новому методу название, которое бы отражало суть того, что он делает. Например, createOrder(), renderCustomerInfo() и т.д.
2. Убирает дублирование кода. Иногда код, вынесенный в метод, можно найти и в других местах программы. В таком случае, имеет смысл заменить найденные участки кода вызовом вашего нового метода.
3. Изолирует независимые части кода, уменьшая вероятность ошибок (например, по вине переопределения не той переменной).

Порядок рефакторинга

1. Создайте новый метод и назовите его так, чтобы название отражало суть того, что будет делать этот метод.
2. Скопируйте беспокоящий вас фрагмент кода в новый метод. Удалите этот фрагмент из старого места и замените вызовом вашего нового метода.
Найдите все переменные, которые использовались в этом фрагменте кода. Если они были объявлены внутри этого фрагмента и не используются вне его, просто оставьте их без изменений — они станут локальными переменными нового метода.
3. Если переменные объявлены перед интересующим вас участком кода, значит, их следует передать в параметры вашего нового метода, чтобы использовать значения, которые в них находились ранее. Иногда от таких переменных проще избавиться с помощью <a href="https://github.com/helenasilkina/refactoring/blob/master/Replace_Temp_with_Query%20(Замена%20переменной%20вызовом%20метода).md">замены переменных вызовом метода</a>.
4. Если вы видите, что локальная переменная как-то изменяется в вашем участке кода, это может означать, что её изменённое значение понадобится дальше в основном методе. Проверьте это. Если подозрение подтвердилось, значение этой переменной следует возвратить в основной метод, чтобы ничего не сломать.
