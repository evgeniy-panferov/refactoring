Параметризация метода

Проблема: Несколько методов выполняют похожие действия, которые отличаются только какими-то внутренними значениями, числами или операциями.

Решение: Объедините все эти методы в один с параметром, в который будет передаваться отличающееся значение.

Причины рефакторинга

1. Если у вас есть схожие методы, скорей всего, в них присутствует дублирующий код со всеми вытекающими недостатками.
2. Кроме того, если вам нужно будет добавить ещё одну вариацию функциональности, вам придётся создавать ещё один метод. Вместо этого можно бы было запустить существующий метод с другим параметром.

Недостатки

1. Иногда при проведении рефакторинга можно переусердствовать, в результате чего у вас появится длинный и сложный общий метод вместо нескольких простых.
2. Кроме того, будьте осторожны, выделяя в параметр переключатель какой-то функциональности. В дальнейшем это может привести к созданию большого условного оператора, который надо будет лечить с помощью замены параметра набором специализированных методов.

Порядок рефакторинга

1. Создайте новый метод с параметром и поместите в него общий для всех методов код, применяя извлечение метода. Обратите внимание, иногда общей оказывается только определённая часть методов. В этом случае рефакторинг сведётся к извлечению только этой общей части в новый метод.
2. Отличающееся значение замените параметром в коде нового метода.
3. Для каждого старого метода найдите места, где они вызываются, и поменяйте их вызовы на вызовы нового метода с параметром. После чего старый метод можно удалить.
