Замена конструктора фабричным методом

Проблема: У вас есть сложный конструктор, делающий нечто большее, чем простая установка значений полей объекта.

Решение: Создайте фабричный метод и замените им вызовы конструктора.

Пример: <a href="https://github.com/helenasilkina/refactoring/blob/master/Replace_Constructor_with_Factory_Method.java">Replace_Constructor_with_Factory_Method.java</a>

Причины рефакторинга

1. Самая очевидная причина применения этого рефакторинга связана с заменой кодирования типа подклассами.
2. У вас есть код, в котором раньше создавался объект, куда передавалось значение кодированного типа. После применения рефакторинга появилось уже несколько подклассов, из которых нужно создавать объекты в зависимости от значения кодированного типа. Изменить оригинальный конструктор так, чтобы он возвращал объекты подклассов, невозможно, поэтому мы создаём статический фабричный метод, который будет возвращать объекты нужных классов, после чего он заменяет собой все вызовы оригинального конструктора.
3. Фабричные методы можно использовать и в других ситуациях, когда возможностей конструкторов оказывается недостаточно. Они важны при замене значения ссылкой. Их можно также применять для задания различных режимов создания, выходящих за рамки числа и типов параметров.

Достоинства

1. Фабричный метод не обязательно возвращает объект того класса, в котором он был вызван. Зачастую это могут быть его подклассы, выбираемые в зависимости от подаваемых в метод аргументов.
2. Фабричный метод может иметь более удачное имя, описывающее, что и каким образом он возвращает, например, Troops::GetCrew(myTank).
3. Фабричный метод может вернуть уже созданный объект в отличие от конструктора, который всегда создает новый экземпляр.

Порядок рефакторинга

1. Создайте фабричный метод. Поместите в его тело вызова текущего конструктора.
2. Замените все вызовы конструктора вызовами фабричного метода.
3. Объявите конструктор приватным.
4. Обследуйте код конструктора и попытайтесь вынести в фабричный метод тот код, который не относится к непосредственному конструированию объекта текущего класса.
