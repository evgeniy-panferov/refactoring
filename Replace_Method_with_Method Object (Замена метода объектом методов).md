Замена метода объектом методов

Проблема

У вас есть длинный метод, в котором локальные переменные так сильно переплетены, что это делает невозможным применение «извлечения метода» (Extract method).

Решение

Преобразуйте метод в отдельный класс так, чтобы локальные переменные стали полями этого класса. После этого можно без труда разделить метод на части.

Причины рефакторинга
Метод слишком длинный, и вы не можете его разделить из-за хитросплетения локальных переменных, которые сложно изолировать друг от друга.

Первым шагом к решению проблемы будет выделение всего этого метода в отдельный класс и превращение его локальных переменных в поля.

Во-первых, это позволит вам изолировать проблему в пределах этого класса, а во-вторых, расчистит дорогу для разделения большого метода на методы поменьше, которые, к тому же, не подходили бы к смыслу оригинального класса.

Достоинства
Изоляция длинного метода в собственном классе позволяет остановить бесконтрольный рост метода. Кроме того, даёт возможность разделить его на подметоды в рамках своего класса, не засоряя служебными методами оригинальный класс.
Недостатки
Создаётся ещё один класс, повышая общую сложность программы.
Порядок рефакторинга
Создайте новый класс. Дайте ему название, основываясь на предназначении метода, который рефакторите.
В новом классе создайте приватное поле для хранения ссылки на экземпляр класса, в котором раньше находился метод.
Создайте отдельное приватное поле для каждой локальной переменной метода.
Создайте конструктор, который принимает в параметрах значения всех локальных переменных метода, а также инициализирует соответствующие приватные поля.
Объявите основной метод и скопируйте в него код оригинального метода, заменив локальные переменные приватным полями.
Замените тело оригинального метода в исходном классе созданием объекта-метода и вызовом его основного метода.
